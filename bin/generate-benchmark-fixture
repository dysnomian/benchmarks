#!/usr/bin/env ruby

require 'rubyXL'
require 'json'

workbook = RubyXL::Parser.parse("./db/seed-data/JEE Benchmarks and Activities.xlsx")
rows = workbook[0]

output = {}

rows.drop(1).each do |row|
  cells = row.cells
  id = cells[0].value
  unless output[id]
    output[id] = {id: id, benchmark: cells[1].value, objective: cells[2].value, capacity: {}}
  end
  capacity_id = cells[3].value.match(/\d/)[0]
  output[id][:capacity][capacity_id] = [] unless output[id][:capacity][capacity_id]
  output[id][:capacity][capacity_id].push(cells[4].value)
end

puts output.to_json
